import datetime


class VulnerabilityStructure:
    """
    Class to create structure for the JSON and functions to generate it
    """

    def __init__(self, initiative: str, consultant: str, jira_issue_key: str, app_code: str, app_name: str,
                 report_date: datetime.date, vul_name: str, technical_rating: str,
                 cvss_vector: str, impact_description: str,
                 comment: str, vendor: str):
        self.initiative = initiative
        self.consultant = consultant
        self.jira_issue_key = jira_issue_key
        self.app_code = app_code
        self.app_name = app_name
        self.report_date = report_date
        self.vul_name = vul_name
        self.technical_rating = technical_rating
        self.cvss_vector = cvss_vector
        self.impact_description = impact_description
        self.comment = comment
        self.vendor = vendor

    def calculate_technical_rating(self) -> int:
        mapping = {
            "Critical": 10,
            "High": 8,
            "Medium": 6,
            "Low": 3,
            "Informational": 0
        }
        return mapping.get(self.technical_rating)
