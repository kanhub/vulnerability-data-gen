import unittest
from ..app.vulns_structure import VulnerabilityStructure
import datetime


class VulnerabilityStructureTest(unittest.TestCase):
    """
    Unit tests for Vulnerability Structure class
    """

    @classmethod
    def setUpClass(cls):
        cls._vulnerability = VulnerabilityStructure("ABCD", "my app1", datetime.date(2019, 10, 11), "SQL Injection",
                                                    7, "AV:A/AC:I/PR",
                                                    "SQL_SQL Injection", "SQL", "Pentest")

    def test_app_code_type(self):
        self.assertTrue(type(self._vulnerability.app_code) is str)

    def test_app_name_type(self):
        self.assertTrue(type(self._vulnerability.app_name) is str)

    def test_report_date_type(self):
        self.assertTrue(type(self._vulnerability.report_date) is datetime.date)

    def test_vul_name_type(self):
        self.assertTrue(type(self._vulnerability.vul_name) is str)

    def test_technical_rating_type(self):
        self.assertTrue(type(self._vulnerability.technical_rating) is int)

    def test_cvss_vector_type(self):
        self.assertTrue(type(self._vulnerability.cvss_vector) is str)

    def test_impact_description_type(self):
        self.assertTrue(type(self._vulnerability.impact_description) is str)

    def test_comment_type(self):
        self.assertTrue(type(self._vulnerability.comment) is str)

    def test_vendor_type(self):
        self.assertTrue(type(self._vulnerability.vendor) is str)

    @classmethod
    def tearDownClass(cls):
        cls._vulnerability = None


if __name__ == '__main__':
    unittest.main()
